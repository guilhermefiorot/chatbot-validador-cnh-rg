# Makefile para Chatbot Validador de Documentos

.PHONY: help install install-dev run test test-cov lint clean

# Comando padrÃ£o
help:
	@echo "ğŸ¤– Chatbot Validador de Documentos - Comandos disponÃ­veis:"
	@echo ""
	@echo "ğŸ“¦ InstalaÃ§Ã£o:"
	@echo "  install      - Instala dependÃªncias de produÃ§Ã£o"
	@echo "  install-dev  - Instala dependÃªncias de desenvolvimento"
	@echo ""
	@echo "ğŸš€ ExecuÃ§Ã£o:"
	@echo "  run          - Executa a aplicaÃ§Ã£o Streamlit"
	@echo "  run-app      - Executa usando o script principal"
	@echo ""
	@echo "ğŸ§ª Testes:"
	@echo "  test         - Executa todos os testes"
	@echo "  test-cov     - Executa testes com cobertura"
	@echo "  test-mapping - Executa testes de mapeamento"
	@echo ""
	@echo "ğŸ”§ Desenvolvimento:"
	@echo "  lint         - Executa linting"
	@echo "  clean        - Remove arquivos temporÃ¡rios"
	@echo "  shell        - Ativa shell do Poetry"

# InstalaÃ§Ã£o
install:
	@echo "ğŸ“¦ Instalando dependÃªncias..."
	poetry install --only main

install-dev:
	@echo "ğŸ“¦ Instalando dependÃªncias de desenvolvimento..."
	poetry install

# ExecuÃ§Ã£o
run:
	@echo "ğŸš€ Executando aplicaÃ§Ã£o Streamlit..."
	poetry run streamlit run src/chatbot_document_validator/app.py

run-app:
	@echo "ğŸš€ Executando aplicaÃ§Ã£o..."
	poetry run python run_app.py

# Testes
test:
	@echo "ğŸ§ª Executando testes..."
	poetry run pytest tests/ -v

test-cov:
	@echo "ğŸ§ª Executando testes com cobertura..."
	poetry run pytest tests/ --cov=src/chatbot_document_validator --cov-report=html --cov-report=term

test-mapping:
	@echo "ğŸ§ª Executando testes de mapeamento..."
	poetry run pytest tests/test_mindee_mapping.py -v

# Desenvolvimento
lint:
	@echo "ğŸ”§ Executando linting..."
	poetry run flake8 src/ tests/ examples/
	poetry run black --check src/ tests/ examples/

format:
	@echo "ğŸ”§ Formatando cÃ³digo..."
	poetry run black src/ tests/ examples/

clean:
	@echo "ğŸ§¹ Limpando arquivos temporÃ¡rios..."
	find . -type f -name "*.pyc" -delete
	find . -type d -name "__pycache__" -delete
	find . -type d -name "*.egg-info" -exec rm -rf {} +
	rm -rf .pytest_cache/
	rm -rf htmlcov/
	rm -rf .coverage

shell:
	@echo "ğŸš Ativando shell do Poetry..."
	poetry shell

# Exemplos
example-basic:
	@echo "ğŸ“ Executando exemplo bÃ¡sico..."
	poetry run python examples/basic_usage.py

example-data:
	@echo "ğŸ“ Executando exemplo de dados..."
	poetry run python examples/sample_data.py

# VerificaÃ§Ã£o de ambiente
check-env:
	@echo "ğŸ” Verificando ambiente..."
	@echo "Python: $(shell poetry run python --version)"
	@echo "Poetry: $(shell poetry --version)"
	@echo "Streamlit: $(shell poetry run streamlit --version)"
	@echo "Pytest: $(shell poetry run pytest --version)" 